#!/usr/bin/env                                                   runhaskell
import System.IO;import Control.Concurrent;import System.Environment;o=True
r w=putStrLn("\^[cflower-seeds "++show w)>>traverse p(map c(g w));a[]=go i
a(b:_)=go(read b);c(a,d)=(z$60+d*cos a,z$0.5*(50+d*sin a));z=round;j=(-1)
i=(29.6,3,400);g(a,d,n)=take n$iterate(\(b,e)->(b+pi*a/90,e+d/30))(0,0)
p (x,y)=threadDelay 1000>>putStrLn("\^[["++show y++";"++show x++"f❤")
main = hSetBuffering stdin NoBuffering >> (getArgs >>= a); e(a,d,n)i=let
 b|i=='j'=j|i=='l'=1|o=0;e|i=='k'=j|i=='i'=1|o=0;m|i=='c'=(-1)|i=='v'=1|o=0
 in go (a+b/20,max 0.1(d+e/10),max 1(n+m*17));go w=r w >> (getChar >>= e w)
-- ^9 -------------------------------------------------------------- 75> --
{- base-10-80/flower-seeds (tristanC)

Copyright 2023, Tristan de Cacqueray
SPDX-License-Identifier: CC-BY-4.0
-}
